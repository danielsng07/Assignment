<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Visual Detective: Insights On Vehicle Movement</title>




  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Visual Detective: Insights On Vehicle Movement"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Visual Detective"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Visual Detective: Insights On Vehicle Movement"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","site"]}},"value":[{"type":"character","attributes":{},"value":["Insights On Vehicle Movement"]},{"type":"character","attributes":{},"value":["distill::distill_article"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs/header-attrs.js"></script>
  <script src="site_libs/popper/popper.min.js"></script>
  <link href="site_libs/tippy/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy/tippy.umd.min.js"></script>
  <script src="site_libs/anchor/anchor.min.js"></script>
  <script src="site_libs/bowser/bowser.min.js"></script>
  <script src="site_libs/webcomponents/webcomponents.js"></script>
  <script src="site_libs/distill/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Insights On Vehicle Movement","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Visual Detective</a>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="about.html">Introduction</a>
<a href="Insights-Cards-Transactions.html">Insights on Cards Transactions</a>
<a href="Insights-Vehicle-Transactions.html">Insights on Vehicle Movement</a>
<a href="Predict-Card-Owners.html">Predict Card owners</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Insights On Vehicle Movement</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>


<div class="d-article">
<h1 id="getting-started">Getting Started</h1>
<h2 id="installing-and-launching-r-packages">Installing and Launching R Packages</h2>
<p>The code chunk below will check if the R packages have been installed, if not, R will install the missing R packages before launching them.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'ggiraph'</span>,<span class='st'>'raster'</span>,<span class='st'>'sf'</span>,<span class='st'>'tmap'</span>,<span class='st'>'clock'</span>,<span class='st'>'gifski'</span>,<span class='st'>'tidyverse'</span>,<span class='st'>'lubridate'</span>,<span class='st'>'DT'</span>,<span class='st'>"lobstr"</span>,<span class='st'>"plotly"</span>,<span class='st'>"distill"</span>,<span class='st'>"patchwork"</span>,<span class='st'>"hms"</span>,<span class='st'>"viridis"</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h2 id="importing-data">Importing Data</h2>
<p>This code chunk import <em>cc_data.csv</em> into R by using <em>read_csv()</em> of <strong>readr</strong> package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_data</span> <span class='op'>&lt;-</span><span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/cc_data.csv"</span>,locale <span class='op'>=</span> <span class='fu'>locale</span><span class='op'>(</span>encoding <span class='op'>=</span> <span class='st'>'windows-1250'</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>loyalty_data</span><span class='op'>&lt;-</span><span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/loyalty_data.csv"</span>,locale <span class='op'>=</span> <span class='fu'>locale</span><span class='op'>(</span>encoding <span class='op'>=</span> <span class='st'>'windows-1250'</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>car_assignment_data</span><span class='op'>&lt;-</span><span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/car-assignments.csv"</span><span class='op'>)</span>
<span class='va'>gps_data</span><span class='op'>&lt;-</span><span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/gps.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="data-preparation">Data Preparation</h1>
<h3 id="transforming-data-for-cc_data.csv">Transforming data for cc_data.csv</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;-</span>  <span class='fu'>date_time_parse</span><span class='op'>(</span><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>timestamp</span>,
                                      zone <span class='op'>=</span> <span class='st'>""</span>,
                                      format <span class='op'>=</span> <span class='st'>"%m/%d/%Y %H:%M"</span><span class='op'>)</span>
<span class='va'>cc_data</span><span class='op'>$</span><span class='va'>last4ccnum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>last4ccnum</span><span class='op'>)</span>
<span class='va'>cc_data</span><span class='op'>$</span><span class='va'>Day</span>  <span class='op'>=</span> <span class='fu'>get_day</span><span class='op'>(</span><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span>
<span class='va'>cc_data</span><span class='op'>$</span><span class='va'>Hour</span> <span class='op'>=</span> <span class='fu'>get_hour</span><span class='op'>(</span><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span>
<span class='va'>cc_data</span><span class='op'>$</span><span class='va'>Min</span> <span class='op'>=</span> <span class='fu'>get_minute</span><span class='op'>(</span><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span>
<span class='va'>cc_data</span><span class='op'>$</span><span class='va'>Weekday</span> <span class='op'>=</span> <span class='fu'>wday</span><span class='op'>(</span><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>timestamp</span>, 
                             label <span class='op'>=</span> <span class='cn'>TRUE</span>, 
                             abbr <span class='op'>=</span> <span class='cn'>TRUE</span>,
                        week_start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"lubridate.week.start"</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>cc_data</span><span class='op'>$</span><span class='va'>Time</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>timestamp</span>, format <span class='op'>=</span> <span class='st'>"%H:%M:%S"</span><span class='op'>)</span>
<span class='va'>cc_data</span><span class='op'>$</span><span class='va'>Time</span> <span class='op'>=</span> <span class='fu'>as.hms</span><span class='op'>(</span><span class='va'>cc_data</span><span class='op'>$</span><span class='va'>Time</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="transforming-data-for-loyalty_data.csv">Transforming data for loyalty_data.csv</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>loyalty_data</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>&lt;-</span> <span class='fu'>date_parse</span><span class='op'>(</span><span class='va'>loyalty_data</span><span class='op'>$</span><span class='va'>timestamp</span>,
                                    format <span class='op'>=</span> <span class='st'>"%m/%d/%Y"</span><span class='op'>)</span>
<span class='va'>loyalty_data</span><span class='op'>$</span><span class='va'>loyaltynum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>loyalty_data</span><span class='op'>$</span><span class='va'>loyaltynum</span><span class='op'>)</span>
<span class='va'>loyalty_data</span><span class='op'>$</span><span class='va'>Day</span> <span class='op'>=</span> <span class='fu'>get_day</span><span class='op'>(</span><span class='va'>loyalty_data</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span>
<span class='va'>loyalty_data</span><span class='op'>$</span><span class='va'>Weekday</span> <span class='op'>=</span> <span class='fu'>wday</span><span class='op'>(</span><span class='va'>loyalty_data</span><span class='op'>$</span><span class='va'>timestamp</span>,
                            label <span class='op'>=</span> <span class='cn'>TRUE</span>,
                            abbr <span class='op'>=</span> <span class='cn'>TRUE</span>,
                            week_start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"lubridate.week.start"</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="transforming-data-for-gps_data.csv">Transforming data for gps_data.csv</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Timestamp</span><span class='op'>&lt;-</span><span class='fu'>date_time_parse</span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Timestamp</span>,
                                    zone <span class='op'>=</span> <span class='st'>""</span>,
                                    format<span class='op'>=</span><span class='st'>"%m/%d/%Y %H:%M:%S"</span><span class='op'>)</span>
<span class='va'>gps_data</span><span class='op'>$</span><span class='va'>id</span><span class='op'>&lt;-</span><span class='fu'>as_factor</span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span> 
<span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Day</span> <span class='op'>=</span> <span class='fu'>get_day</span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Timestamp</span><span class='op'>)</span>
<span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Hour</span> <span class='op'>=</span> <span class='fu'>get_hour</span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Timestamp</span><span class='op'>)</span>
<span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Min</span> <span class='op'>=</span> <span class='fu'>get_minute</span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Timestamp</span><span class='op'>)</span>
<span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Sec</span> <span class='op'>=</span> <span class='fu'>get_second</span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Timestamp</span><span class='op'>)</span>
<span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Weekday</span> <span class='op'>=</span> <span class='fu'>wday</span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Timestamp</span>,
                            label <span class='op'>=</span> <span class='cn'>TRUE</span>,
                            abbr <span class='op'>=</span> <span class='cn'>TRUE</span>,
                            week_start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"lubridate.week.start"</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Time</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Timestamp</span>, format <span class='op'>=</span> <span class='st'>"%H:%M:%S"</span><span class='op'>)</span>
<span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Time</span> <span class='op'>=</span> <span class='fu'>as.hms</span><span class='op'>(</span><span class='va'>gps_data</span><span class='op'>$</span><span class='va'>Time</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="transforming-data-for-car-assignments.csv">Transforming data for car-assignments.csv</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_assignment_data</span><span class='op'>$</span><span class='va'>CarID</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>car_assignment_data</span><span class='op'>$</span><span class='va'>CarID</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="joining-gps-data-and-car-assignment-data-using-carid">Joining GPS Data and Car Assignment Data using CarID</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>driver_location_data</span><span class='op'>&lt;-</span><span class='va'>gps_data</span> <span class='op'>%&gt;%</span>
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>car_assignment_data</span>,by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span><span class='op'>=</span><span class='st'>"CarID"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>replace_na</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>FirstName <span class='op'>=</span> <span class='st'>"Unknown"</span>, LastName <span class='op'>=</span> <span class='st'>"Driver"</span>, CurrentEmploymentType <span class='op'>=</span> <span class='st'>"Unknown"</span> ,CurrentEmploymentTitle <span class='op'>=</span> <span class='st'>"Unknown"</span> <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unite</span><span class='op'>(</span><span class='st'>"Name"</span>,<span class='va'>FirstName</span>,<span class='va'>LastName</span>, sep <span class='op'>=</span> <span class='st'>" "</span>, remove <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<h3 id="setting-up-the-tourist-map">Setting up the tourist map</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bgmap</span><span class='op'>&lt;-</span><span class='fu'>raster</span><span class='op'>(</span><span class='st'>"data/Geospatial/MC2-tourist.tif"</span><span class='op'>)</span>
<span class='va'>bgmap</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
band       : 1  (of  3  bands)
dimensions : 1595, 2706, 4316070  (nrow, ncol, ncell)
resolution : 3.16216e-05, 3.16216e-05  (x, y)
extent     : 24.82419, 24.90976, 36.04499, 36.09543  (xmin, xmax, ymin, ymax)
crs        : +proj=longlat +datum=WGS84 +no_defs 
source     : MC2-tourist.tif 
names      : MC2.tourist 
values     : 0, 255  (min, max)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>bgmap</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='va'>bgmap</span>,
            legend.show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>bgmap</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_rgb</span><span class='op'>(</span><span class='va'>bgmap</span>, r <span class='op'>=</span><span class='fl'>1</span>,g<span class='op'>=</span><span class='fl'>2</span>,b<span class='op'>=</span><span class='fl'>3</span>,
         alpha<span class='op'>=</span><span class='cn'>NA</span>,
         saturation <span class='op'>=</span> <span class='fl'>1</span>,
         interpolate <span class='op'>=</span> <span class='cn'>TRUE</span>,
         max.value<span class='op'>=</span><span class='fl'>255</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Abila_st</span><span class='op'>&lt;-</span><span class='fu'>st_read</span><span class='op'>(</span>dsn<span class='op'>=</span><span class='st'>"data/Geospatial"</span>,layer<span class='op'>=</span><span class='st'>"Abila"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Reading layer `Abila&#39; from data source 
  `C:\danielsng07\Assignment\data\Geospatial&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 3290 features and 9 fields
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: 24.82401 ymin: 36.04502 xmax: 24.90997 ymax: 36.09492
Geodetic CRS:  WGS 84</code></pre>
</div>
<h3 id="creating-the-stop-time-and-duration-of-during-the-stop-time-for-all-cars">Creating the stop time and duration of during the stop time for all cars</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>CarMovement</span><span class='op'>&lt;-</span> <span class='va'>driver_location_data</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>VehicleStopTime<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/lag.html'>lag</a></span><span class='op'>(</span><span class='va'>Time</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>stopduration<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/difftime.html'>difftime</a></span><span class='op'>(</span><span class='va'>Time</span>,<span class='va'>VehicleStopTime</span>,units <span class='op'>=</span> <span class='st'>"mins"</span><span class='op'>)</span>,digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="task-2">Task 2</h1>
<h2 id="with-the-addition-of-vehicle-data-to-the-credit-and-loyalty-card-data-does-your-assessment-of-the-anomalies-in-question-1-change">With the addition of Vehicle data to the credit and loyalty card data, does your assessment of the anomalies in question 1 change?</h2>
<p>The vehicle data have its limitation where there is only Latitude and Longitude of the car movement are provided in the data. We will have to track each vehicle manually to find out where the car move to by plotting out the car movement in the tourist map over the two weeks. We will have to use the vechicle stop time and duration to understand the behaviour of the car movement. This is often a tedious process as there are a total of 35 cars ID and 5 trucks ID moving around the different part of the map. We also found out where the cars with assigned employees (Car ID 1 to 35) stay from the first movement of the car at the start of each day. Based on some key observations from the vehicle movement, we can identify potential informal or unofficial relationships among GASTech personnel.</p>
<h3 id="to-investigate-the-driving-patterns-of-all-vehicles-carid-1-to-35101104105106107-from-6-jan-2014-to-19-jan-2014">To investigate the driving patterns of all vehicles (CarID 1 to 35,101,104,105,106,107 ) from 6 Jan 2014 to 19 Jan 2014</h3>
<h4 id="understanding-the-drivers-travelling-patterns">Understanding the drivers travelling patterns</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>CarMovement</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Day</span>,y<span class='op'>=</span><span class='va'>Time</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>geom_tile</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Drivers daily driving pattern from 6 Jan to 10 Jan 2014"</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>expand_limits</span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span><span class='st'>"Day"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<p>We scanned through all the cars and trucks movement over the 2 weeks and found some abnormal behaviour of some car movement.</p>
<h3 id="major-findings-1-employees-in-the-security-department-that-have-weird-movement-in-the-early-morning">Major findings 1 (Employees in the security department that have weird movement in the early morning)</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Security_Movement</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>CurrentEmploymentType</span><span class='op'>==</span><span class='st'>"Security"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Day</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>stopduration</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>Timestamp</span>,<span class='va'>id</span>, <span class='va'>Name</span>,<span class='va'>CurrentEmploymentType</span>, <span class='va'>CurrentEmploymentTitle</span>,<span class='va'>Day</span>, <span class='va'>Weekday</span>,<span class='va'>Hour</span>,<span class='va'>Time</span>,<span class='va'>VehicleStopTime</span>,<span class='va'>stopduration</span><span class='op'>)</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>Security_Movement</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Day</span>,y<span class='op'>=</span><span class='va'>Hour</span>,color<span class='op'>=</span><span class='va'>Weekday</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>expand_limits</span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span><span class='st'>"Day"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span><span class='st'>"hour"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>scale_color_brewer</span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Dark2"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<p>During those day in the early morning, some of the security employees drive to the home area of CFO Ingrid Barranco (CarID 4), CIO Ada Campo-Corrente (CarID 10) and Willem Vasco-Pais (CarID 35) who is the Environmental Safety Advisor.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>SecuritySuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-07 01:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-07 04:00:00"</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>SecuritySuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<p>They returned again on 9 Jan in the odd early hour of the day.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>SecuritySuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-09 02:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-09 04:00:00"</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>SecuritySuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-1">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<p>They act again on 11 Jan and subsequently on 14 Jan too.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>SecuritySuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-11 02:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-11 04:00:00"</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>SecuritySuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-2">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-26-1.png" width="624" /></p>
</div>
<p>CarID 15,16,21,24 are all from the security department, they are Isia Yann, Hennie Osvaldo, Loreto Bodrogi and Minke Mies. They set off from the same place and these 4 drivers stayed at the same place. They are highly suspicious in their actions.</p>
<h3 id="major-findings-2-all-employees-in-the-information-technology-department-work-during-normal-hours-the-exception-of-carid-1-which-is-assigned-to-nils-calixto">Major Findings 2 : All employees in the Information Technology Department work during normal hours the exception of CarID 1 which is assigned to Nils Calixto</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ITDepart</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>CurrentEmploymentType</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Information Technology"</span><span class='op'>)</span>,<span class='va'>id</span><span class='op'>!=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Day</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>stopduration</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>Timestamp</span>,<span class='va'>id</span>, <span class='va'>Name</span>,<span class='va'>CurrentEmploymentType</span>, <span class='va'>CurrentEmploymentTitle</span>,<span class='va'>Day</span>, <span class='va'>Weekday</span>,<span class='va'>Hour</span>,<span class='va'>Time</span>,<span class='va'>VehicleStopTime</span>,<span class='va'>stopduration</span><span class='op'>)</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>ITDepart</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Day</span>,y<span class='op'>=</span><span class='va'>Hour</span>,color<span class='op'>=</span><span class='va'>Weekday</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>expand_limits</span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span><span class='st'>"Day"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span><span class='st'>"hour"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>scale_color_brewer</span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Dark2"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ITDepart</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Day</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>stopduration</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>Timestamp</span>,<span class='va'>id</span>, <span class='va'>Name</span>,<span class='va'>CurrentEmploymentType</span>, <span class='va'>CurrentEmploymentTitle</span>,<span class='va'>Day</span>, <span class='va'>Weekday</span>,<span class='va'>Hour</span>,<span class='va'>Time</span>,<span class='va'>VehicleStopTime</span>,<span class='va'>stopduration</span><span class='op'>)</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>ITDepart</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Day</span>,y<span class='op'>=</span><span class='va'>Hour</span>,color<span class='op'>=</span><span class='va'>Weekday</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>expand_limits</span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span><span class='st'>"Day"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span><span class='st'>"hour"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>scale_color_brewer</span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Dark2"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-28-1.png" width="624" /></p>
</div>
<p>Nils Calixto have car movement during the early hours of the day and we found that he returned to office during these time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Car1SuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-06 22:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-07 03:00:00"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>Car1SuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-3">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-32-1.png" width="624" /></p>
</div>
<p>He went back to office again on 8 Jan and stay on till early morning of 9 Jan.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Car1SuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-08 21:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-09 04:00:00"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>Car1SuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-4">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-36-1.png" width="624" /></p>
</div>
<p>Nils Calixto is showing abnormal activities on returning to office at abnormal time as compared to his colleagues from the same department. It is unknown on what he is doing in office.</p>
<h3 id="major-findings-3-two-employees-visited-chostus-hotel-during-weekday-afternoon-several-times-during-the-two-weeks">Major findings 3 (Two employees visited Chostus Hotel during weekday afternoon several times during the two weeks)</h3>
<p>It is found that CarID7 Elsa Orilla and CarID 33 Brand Tempestad visited Chostus Hotel several times during weekday afternoon before returning to office.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>HotelSuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-08 11:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-08 14:00:00"</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>HotelSuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-5">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-40-1.png" width="624" /></p>
</div>
<p>They went to Chostus Hotel on 8 Jan afternoon. The same travelling pattern is repeated again on 10 Jan afternoon.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>HotelSuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-10 11:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-10 14:00:00"</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>HotelSuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-6">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-44-1.png" width="624" /></p>
</div>
<p>In addition, they both went to Chostus Hotel on 2 more afternoon which is on 14 Jan and 17 Jan.A total of 4 trips together, it is unknown on their relationship.</p>
<h3 id="major-findings-4-10-jan-friday-evening-gathering-with-10-gastech-employees-involved">Major findings 4 (10 Jan (Friday) evening gathering with 10 GAStech Employees involved)</h3>
<p>The locations these employees went to seems to be either Lars Azada (CarID2) and Axel Calzas home along Carnero Street. The employees involved in this gathering are Nils Calixto (CarID1), Felix Balas(CarID3),Isak Baza (CarID5), Linnea Bergen (CarID6,) Elsa Orilla (CarID7), Lidelse Dedos (CarID14), Birgitta Frente (CarID18), Vira Frente (CarID19), Kanon Herrero (CarID25) and Marin Onda (CarID26).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>GatheringSuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-10 19:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-10 23:59:00"</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>GatheringSuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-7">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-48-1.png" width="624" /></p>
</div>
<p>These employee involved in this gathering are from only two department, 3 from Information Technology and 7 from Engineering department.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code># A tibble: 2 x 2
  CurrentEmploymentType      n
  &lt;chr&gt;                  &lt;int&gt;
1 Engineering                7
2 Information Technology     3</code></pre>
</div>
<h3 id="major-findings-5-weekend-golf-gathering-among-the-executives">Major findings 5 (Weekend golf gathering among the executives)</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>GolfSuspiciousTime</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Weekday</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sat"</span>,<span class='st'>"Sun"</span><span class='op'>)</span>,<span class='va'>CurrentEmploymentType</span><span class='op'>==</span><span class='st'>"Executive"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>GolfSuspiciousTime</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-8">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-53-1.png" width="624" /></p>
</div>
<p>Desafio Golf Course are only visited by GAStech executives.However the vehicle data for CarID31 which is assigned to Sten Sanjorge (CEO), only show up on 17, 18 and 19 Jan.His location at the start of each day is from Chostus Hotel. We suspect he is only visiting the company during this short stay.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>CEO</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>==</span><span class='fl'>31</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Day</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>stopduration</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>Timestamp</span>,<span class='va'>id</span>, <span class='va'>Name</span>,<span class='va'>CurrentEmploymentType</span>, <span class='va'>CurrentEmploymentTitle</span>,<span class='va'>Day</span>, <span class='va'>Weekday</span>,<span class='va'>Hour</span>,<span class='va'>Time</span>,<span class='va'>VehicleStopTime</span>,<span class='va'>stopduration</span><span class='op'>)</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>CEO</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Day</span>,y<span class='op'>=</span><span class='va'>Hour</span>,color<span class='op'>=</span><span class='va'>Weekday</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>expand_limits</span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span><span class='st'>"Day"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span><span class='st'>"hour"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>scale_color_brewer</span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Dark2"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-54-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>CEOatHotel</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Timestamp</span> <span class='op'>&gt;</span> <span class='st'>"2014-01-17 06:00:00"</span> <span class='op'>&amp;</span> <span class='va'>Timestamp</span> <span class='op'>&lt;=</span><span class='st'>"2014-01-17 08:00:00"</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>CEOatHotel</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-9">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-58-1.png" width="624" /></p>
</div>
<p>The location he set off is from Chostus Hotel at the start of the day.</p>
<h3 id="major-findings-6-the-company-truck-only-move-on-weekday-and-goes-to-specific-locations">Major findings 6 (the company truck only move on weekday and goes to specific locations)</h3>
<p>The company vehicles which are meant for business uses only goes to specific location such as Abila Airport, Abila Scrap and Abila Port, Maximum Iron and Steel. The only anomaly is that truck 105 only goes to Katerinas Caf.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>TruckMovement</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"101"</span>,<span class='st'>"104"</span>,<span class='st'>"105"</span>,<span class='st'>"106"</span>,<span class='st'>"107"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Day</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>stopduration</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>Timestamp</span>,<span class='va'>id</span>, <span class='va'>Name</span>,<span class='va'>CurrentEmploymentType</span>, <span class='va'>CurrentEmploymentTitle</span>,<span class='va'>Day</span>, <span class='va'>Weekday</span>,<span class='va'>Hour</span>,<span class='va'>Time</span>,<span class='va'>VehicleStopTime</span>,<span class='va'>stopduration</span><span class='op'>)</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>TruckMovement</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Day</span>,y<span class='op'>=</span><span class='va'>Hour</span>,color<span class='op'>=</span><span class='va'>Weekday</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>expand_limits</span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span><span class='st'>"Day"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span><span class='st'>"hour"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>scale_color_brewer</span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Dark2"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-59-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>TruckMovement</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Weekday</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Mon"</span>,<span class='st'>"Tue"</span>,<span class='st'>"Wed"</span>,<span class='st'>"Thu"</span>,<span class='st'>"Fri"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>TruckMovement</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-10">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-63-1.png" width="624" /></p>
</div>
<h3 id="truck105-only-goes-to-katerinas-caf">Truck105 only goes to Katerinas Caf</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>TruckMovement</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Weekday</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Mon"</span>,<span class='st'>"Tue"</span>,<span class='st'>"Wed"</span>,<span class='st'>"Thu"</span>,<span class='st'>"Fri"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>TruckMovement</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-11">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-67-1.png" width="624" /></p>
</div>
<p>It is very strange that the truck 105 movement differ from the other truck.</p>
<h3 id="major-findings-7-kronos-capitol">Major findings 7 (Kronos Capitol)</h3>
<p>There are 5 cars that visit Kronos Capitol over weekend. This location looks to be a government office as there is a flag over the building. These cars are assigned to Loreto Bodrogi (CarID15), Adra Nubarron (CarID22), Kanon Herrero (CarID25), Edvard Vann (CarID34) and Willem Vasco-Pais (CarID35).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>TruckMovement</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"15"</span>,<span class='st'>"22"</span>,<span class='st'>"25"</span>,<span class='st'>"34"</span>,<span class='st'>"35"</span><span class='op'>)</span>,<span class='va'>Weekday</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sat"</span>,<span class='st'>"sun"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>TruckMovement</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-12">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-71-1.png" width="624" /></p>
</div>
<h3 id="summary-of-findings">Summary of findings</h3>
<ol type="1">
<li><p>Using the GPS data, we can identify place of interest or suspicious behaviours of the employees. USing the place of interest which employees visited together to identify their relationship. They could be close friends which they hang out together.</p></li>
<li><p>The employees (Isia Yann, Hennie Osvaldo, Loreto Bodrogi and Minke Mies) from Security department which spy at CFO and CIO home during the early hours are suspects. From the location they set off everyday, it can be concluded that they are staying together. They took turns to go to CFO and CIO home and it is unsure on what they are doing for going there in those hours.</p></li>
<li><p>Nils Calixto from Information Technology return to office during the odd early hours on a few occasions. His behaviour is suspicious as there are no employee who return to office at those hours during this two weeks. He is the only person who have done so.</p></li>
</ol>
<h3 id="discrepancies-of-the-vehicle-credit-card-and-loyalty-card-data">Discrepancies of the vehicle, credit card and loyalty card data</h3>
<ol type="1">
<li>There are vehicle data which show erroneous GPS records.</li>
</ol>
<p>For example, in the case of CarID28, we cannot infer where the car is going to or where the car set off everyday.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Car28mov</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='fl'>28</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>Car28mov</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-13">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-75-1.png" width="624" /></p>
</div>
<p>CarID28 have a driving path that are very messy. We couldnt identify where the car is moving to most of the time.</p>
<ol start="2" type="1">
<li>Some of the locations that the cars goes to in the map have no landmark indicated, it is unknown where this place is.</li>
</ol>
<p>For example, CarID3 went to a location near Frank Fuel over the weekend but this place is a unknown place.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>UnknownLoc</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='fl'>3</span>, <span class='va'>Weekday</span><span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sat"</span>,<span class='st'>"sun"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_sf</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>UnknownLoc</span>,
                 coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>,<span class='st'>"lat"</span><span class='op'>)</span>,
                 crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_path</span><span class='op'>&lt;-</span><span class='va'>gps_sf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>m<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Timestamp</span><span class='op'>)</span>,
            do_union<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_cast</span><span class='op'>(</span><span class='st'>"LINESTRING"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="overplot-the-gps-path-of-driver-id-onto-the-background-tourist-map.-14">overplot the gps path of driver ID onto the background tourist map.</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-79-1.png" width="624" /></p>
</div>
<p>The location near Frank Fuel is unknown.</p>
<ol start="3" type="1">
<li>It is unknown or not explained on why there is only 3 days records of CEO data.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>CEO</span><span class='op'>&lt;-</span><span class='va'>CarMovement</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>==</span><span class='fl'>31</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Day</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>stopduration</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>Timestamp</span>,<span class='va'>id</span>, <span class='va'>Name</span>,<span class='va'>CurrentEmploymentType</span>, <span class='va'>CurrentEmploymentTitle</span>,<span class='va'>Day</span>, <span class='va'>Weekday</span>,<span class='va'>Hour</span>,<span class='va'>Time</span>,<span class='va'>VehicleStopTime</span>,<span class='va'>stopduration</span><span class='op'>)</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>CEO</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Day</span>,y<span class='op'>=</span><span class='va'>Hour</span>,color<span class='op'>=</span><span class='va'>Weekday</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>expand_limits</span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span><span class='st'>"Day"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>19</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span><span class='st'>"hour"</span>,limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>23</span>,<span class='fl'>1</span><span class='op'>)</span>,expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>scale_color_brewer</span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Dark2"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Insights-Vehicle-Transactions_files/figure-html5/unnamed-chunk-80-1.png" width="624" /></p>
</div>
<ol start="4" type="1">
<li><p>One of the popular locations (Hippokampos) in the credit card and loyalty card are not found in the map.</p></li>
<li><p>There are high spending found in the card transactions record at locations such as Abila Aiport, Maximum Iron and Steel and Abila Scrapyard. However these locations are visited mainly by company trucks and these trucks are not assigned to any employees. There are a total of 9 Truck drivers, hence it is hard to infer who spend at these locations,</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">  <span class='va'>Loc_Sales_lc</span><span class='op'>&lt;-</span><span class='va'>loyalty_data</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>summarise</span><span class='op'>(</span>Average_Sales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>price</span><span class='op'>)</span>, Max_Sales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>price</span><span class='op'>)</span>, Min_Sales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>price</span><span class='op'>)</span>, Total_Sales<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>price</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>Total_Sales</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>33</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 33 x 5
   location              Average_Sales Max_Sales Min_Sales Total_Sales
   &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
 1 Abila Airport                2662.     4898.     125.       69205. 
 2 Nationwide Refinery          1947.     4743.     205.       44791. 
 3 Carlyle Chemical Inc.        2272.     4984.     228.       43173. 
 4 Stewart and Sons Fab~        2284.     4543.     279.       38822. 
 5 Maximum Iron and Ste~        2701.     4788.     690.       16208. 
 6 Kronos Pipe and Irri~        2270.     3921.     242.       13619. 
 7 Abila Scrapyard              2371.     4277.    1158.        9482. 
 8 Frydos Autosupply n&#39;~         153.      282.      18.9       6443. 
 9 Albert&#39;s Fine Clothi~         218.     1239.      35.7       5439. 
10 Katerinas Caf                27.7      96.4      8.01      5405. 
11 Hippokampos                    29.2     101.       8.43      4533. 
12 Guy&#39;s Gyros                    26.1      65.2      8.23      3808. 
13 Shoppers&#39; Delight             170.      294.      16.8       3052. 
14 Ouzeri Elian                   29.2     117.       8.32      2451. 
15 General Grocer                173.      478.      70.2       2077. 
16 Abila Zacharo                  27.7     112.       8.16      1970. 
17 Kalami Kafenion                28.4     141.       8.64      1872. 
18 Gelatogalore                   26.1      50.4      8.6       1568. 
19 Brew&#39;ve Been Served            10.9      19.9      3         1520. 
20 Kronos Mart                   186.      286.      87.7       1488. 
21 Chostus Hotel                 174.      600      108.        1389. 
22 Desafio Golf Course           154.      198.     110.        1234. 
23 Roberts and Sons              195.      267.      62.5       1169. 
24 Hallowed Grounds               12.0      20.0      3.11       962. 
25 Bean There Done That           12.0      19.8      3.92       542. 
26 Ahaggo Museum                  74.1     120.      26.9        444. 
27 Jack&#39;s Magical Beans           12.1      19.6      3.36       425. 
28 Coffee Cameleon                11.2      20.0      3.14       416. 
29 Octavio&#39;s Office Sup~         112.      140.      64.5        335. 
30 Brewed Awakenings              10.8      17.7      3.62       313. 
31 Frank&#39;s Fuel                   59        65.3     52.7        118  
32 Coffee Shack                   11.3      19.2      3.63       102. 
33 U-Pump                         59.5      59.5     59.5         59.5</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">  <span class='va'>car_assignment_data</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>CurrentEmploymentTitle</span><span class='op'>==</span><span class='st'>"Truck Driver"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 9 x 5
  LastName  FirstName CarID CurrentEmploymentTy~ CurrentEmploymentTit~
  &lt;chr&gt;     &lt;chr&gt;     &lt;fct&gt; &lt;chr&gt;                &lt;chr&gt;                
1 Hafon     Albina    &lt;NA&gt;  Facilities           Truck Driver         
2 Hawelon   Benito    &lt;NA&gt;  Facilities           Truck Driver         
3 Hawelon   Claudio   &lt;NA&gt;  Facilities           Truck Driver         
4 Mies      Henk      &lt;NA&gt;  Facilities           Truck Driver         
5 Morlun    Valeria   &lt;NA&gt;  Facilities           Truck Driver         
6 Morlun    Adan      &lt;NA&gt;  Facilities           Truck Driver         
7 Morluniau Cecilia   &lt;NA&gt;  Facilities           Truck Driver         
8 Nant      Irene     &lt;NA&gt;  Facilities           Truck Driver         
9 Scozzese  Dylan     &lt;NA&gt;  Facilities           Truck Driver         </code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
